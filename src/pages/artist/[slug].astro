---
import Nav from "../../components/Nav.astro";
import "../../style/generalstyle.css";

import Footer from "../../components/Footer.astro";
export async function getStaticPaths() {
  const data = await fetch("https://qqlcqmrveupfwluwoctv.supabase.co/rest/v1/affiliatedCphData", {
    method: "GET",
    headers: {
      apikey: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFxbGNxbXJ2ZXVwZndsdXdvY3R2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MDc3MzQ3MzQsImV4cCI6MjAyMzMxMDczNH0.18SZnOZc5uAHdiIeonTl5cOenfcDIkL4VOhqSCsTFwM",
    },
  }).then((response) => response.json());

  return data.map((artist) => {
    return {
      params: { slug: artist.slug },
      props: { myData: artist },
    };
  });
}

const { myData } = Astro.props;

// {
//   id: 5,
//   kunsterNavn: 'MILEZ',
//   beskrivelse: null,
//   kunsterBillede1: 'milez_card.webp',
//   kunsterBillede2: 'milez_singleview.png',
//   spotifyPlaylistLink: null,
//   facebookLogoLink: null,
//   instagramLogoLink: null,
//   spotifyLogoLink: null,
//   slug: 'Milez'
// }
---

<a href="../#frontpage"><div class="arrow_background"><img class="arrow" src="../img/normalArrowH.svg" alt="" /></div></a>
<section class="singleview_img">
  <img class="artist_img" src={"/public/images/" + `${myData.kunsterBillede2}`} alt="billede af artist" />
  <div class="name_scrollbar">
    <h1 class="parallax_name">{myData.kunsterNavn}</h1>
  </div>
</section>

<section class="singleview_grid">
  <div class="artist_info">
    <div class="col_flexSingle">
      <h3>{myData.kunsterNavn}</h3>
      <div class="icon_container singleview menu-links">
        <ul class="icon_container">
          <li>
            <a class="social-icon" href=`${myData.spotifyLogoLink}`><i class="fab fa-spotify fa-2xl"></i></a>
          </li>
          <li><a class="social-icon" href=`${myData.youtubeLogoLink}`><i class="fab fa-youtube fa-2xl"></i></a></li>
          <li>
            <a class="social-icon" href=`${myData.instagramLogoLink}`><i class="fab fa-instagram fa-2xl"></i></a>
          </li>
          <li>
            <a class="social-icon" href=`${myData.facebookLogoLink}`><i class="fab fa-facebook fa-2xl"></i></a>
          </li>
        </ul>
      </div>
    </div>
    <p>{myData.beskrivelse}</p>
  </div>

  <div id="embed-iframe">
    <iframe
      style="border-radius:12px"
      src=`https://open.spotify.com/embed/${myData.spotifyPlaylistLink}`
      width="100%"
      height="352"
      frameBorder="0"
      allowfullscreen=""
      allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
      loading="lazy"></iframe>
  </div>
</section>

<Footer />

<style>
  .icon_container {
    display: flex;
    flex-direction: row;
    position: relative;
    bottom: 2vh;
  }
  .icon_container a {
    margin: 0.5rem;
    font-size: 0.65rem;
  }
  .social-icon {
    width: 100%;
  }
  .icon_container li {
    list-style-type: none;
  }
  a {
    text-decoration: none;
    color: var(--backgroundColor);
  }

  .social-icon:hover {
    color: var(--accentColor);
  }
  .singleview a {
    color: var(--textColor);
    font-size: 0.65rem;
  }
  .singleview a:hover {
    color: var(--accentColor);
  }
  .singleview {
    display: flex;
    margin: 3rem 5rem 0 5rem;
  }
  .arrow {
    opacity: 100%;
    width: 3rem;
  }
  .arrow_background {
    background-color: #efece5;
    /* border: solid 0.5rem #efece5; */
    border-radius: 1.3rem;
    opacity: 80%;
    rotate: 270deg;
    position: absolute;
    z-index: 10;
    margin: 1rem 1rem 1rem 2rem;
    padding: 1.5rem 1rem;
  }
  .singleview_img {
    position: relative;
    overflow: hidden;
    background-color: rgba(42, 36, 32, 1);
    box-shadow: inset 0 -1em 5px rgb(0 0 0 / 100%);
  }

  .artist_img {
    width: 100%;
    height: auto;
    background-size: cover;
    background-repeat: no-repeat;
    background-position: center;
    opacity: 75%;
  }
  .name_scrollbar {
    position: absolute;
    top: 20%;
    left: 50%;
    transform: translateX(-50%);
    white-space: nowrap;
  }

  .parallax_name {
    display: inline-block;
    color: var(--backgroundColor);
    font-size: 2rem;
    transition: transform 0.1s ease-out;
  }

  .singleview_links {
    display: flex;
    flex-direction: row;
  }

  h3 {
    /* margin: 1rem 5rem 2rem 3rem; */
    font-size: 24px;
  }
  p {
    margin: 1rem 3rem 2rem 3rem;
  }

  .col_flexSingle {
    display: flex;
    flex-direction: row;
    margin-left: 2.8rem;
  }
  #embed-iframe {
    margin-bottom: 3rem;
  }

  @keyframes scrollText {
    from {
      transform: translateX(0%);
    }
    to {
      transform: translateX(-60%);
    }
  }

  @media screen and (min-width: 700px) {
    .singleview_grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      margin: 5rem 5rem 15rem 5rem;
      gap: 5rem;
    }

    .name_scrollbar {
      top: 20%;
    }

    .parallax_name {
      font-size: 7rem;
    }
    .artist_img {
      width: 100%;
      background-size: cover;
      height: auto;
      margin: auto;
    }
    h3 {
      font-size: 36px;
    }
    .singleview {
      display: flex;
    }
    .singleview a {
      font-size: 1rem;
    }
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    document.addEventListener("scroll", function () {
      const parallaxElements = document.querySelectorAll(".parallax_name");
      parallaxElements.forEach(function (el) {
        let scrolled = window.scrollY;

        el.style.transform = "translateY(" + scrolled * 0.5 + "px)";
      });
    });
  });
</script>
