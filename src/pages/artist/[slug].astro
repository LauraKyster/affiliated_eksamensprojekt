---
export async function getStaticPaths() {
  const data = await fetch(
    "https://qqlcqmrveupfwluwoctv.supabase.co/rest/v1/affiliatedCphData",
    {
      method: "GET",
      headers: {
        apikey:
          "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFxbGNxbXJ2ZXVwZndsdXdvY3R2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MDc3MzQ3MzQsImV4cCI6MjAyMzMxMDczNH0.18SZnOZc5uAHdiIeonTl5cOenfcDIkL4VOhqSCsTFwM",
      },
    }
  ).then((response) => response.json());

  return data.map((artist) => {
    return {
      params: { slug: artist.slug },
      props: { myData: artist },
    };
  });
}

const { myData } = Astro.props;
console.log(myData);

// {
//   id: 5,
//   kunsterNavn: 'MILEZ',
//   beskrivelse: null,
//   kunsterBillede1: 'milez_card.webp',
//   kunsterBillede2: 'milez_singleview.png',
//   spotifyPlaylistLink: null,
//   facebookLogoLink: null,
//   instagramLogoLink: null,
//   spotifyLogoLink: null,
//   slug: 'Milez'
// }
---

<section class="singleview_img">
  <img
    src={"/public/images/" + `${myData.kunsterBillede2}`}
    alt="billede af artist"
    ;
  />
  <h1>{myData.kunsterNavn}</h1>
</section>
<section class="artist_info">
  <div class="singleview_grid">
    <div class="singleview_text">
      <h3>{myData.kunsterNavn}</h3>
      <p>{myData.beskrivelse}</p>
    </div>
    <div class="singleview_links"></div>
  </div>
  <div id="embed-iframe">
    <iframe
      style="border-radius:12px"
      src=`https://open.spotify.com/embed/${myData.spotifyPlaylistLink}`
      width="100%"
      height="352"
      frameBorder="
      0"
      allowfullscreen=""
      allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
      loading="lazy"></iframe>
  </div>
</section>
